"use strict";(self.webpackChunkprivacy_sandbox_demos=self.webpackChunkprivacy_sandbox_demos||[]).push([[559],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>g});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=n.createContext({}),u=function(e){var t=n.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},c=function(e){var t=u(e.components);return n.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(r),h=a,g=p["".concat(l,".").concat(h)]||p[h]||d[h]||i;return r?n.createElement(g,o(o({ref:t},c),{},{components:r})):n.createElement(g,o({ref:t},c))}));function g(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,o=new Array(i);o[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:a,o[1]=s;for(var u=2;u<i;u++)o[u]=r[u];return n.createElement.apply(null,o)}return n.createElement.apply(null,r)}h.displayName="MDXCreateElement"},5162:(e,t,r)=>{r.d(t,{Z:()=>o});var n=r(7294),a=r(6010);const i={tabItem:"tabItem_Ymn6"};function o(e){let{children:t,hidden:r,className:o}=e;return n.createElement("div",{role:"tabpanel",className:(0,a.Z)(i.tabItem,o),hidden:r},t)}},4866:(e,t,r)=>{r.d(t,{Z:()=>w});var n=r(7462),a=r(7294),i=r(6010),o=r(2466),s=r(6550),l=r(1980),u=r(7392),c=r(12);function p(e){return function(e){return a.Children.map(e,(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:r,attributes:n,default:a}}=e;return{value:t,label:r,attributes:n,default:a}}))}function d(e){const{values:t,children:r}=e;return(0,a.useMemo)((()=>{const e=t??p(r);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function h(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function g(e){let{queryString:t=!1,groupId:r}=e;const n=(0,s.k6)(),i=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,l._X)(i),(0,a.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(n.location.search);t.set(i,e),n.replace({...n.location,search:t.toString()})}),[i,n])]}function m(e){const{defaultValue:t,queryString:r=!1,groupId:n}=e,i=d(e),[o,s]=(0,a.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=r.find((e=>e.default))??r[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:i}))),[l,u]=g({queryString:r,groupId:n}),[p,m]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,i]=(0,c.Nk)(r);return[n,(0,a.useCallback)((e=>{r&&i.set(e)}),[r,i])]}({groupId:n}),b=(()=>{const e=l??p;return h({value:e,tabValues:i})?e:null})();(0,a.useLayoutEffect)((()=>{b&&s(b)}),[b]);return{selectedValue:o,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);s(e),u(e),m(e)}),[u,m,i]),tabValues:i}}var b=r(2389);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function k(e){let{className:t,block:r,selectedValue:s,selectValue:l,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,o.o5)(),d=e=>{const t=e.currentTarget,r=c.indexOf(t),n=u[r].value;n!==s&&(p(t),l(n))},h=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const r=c.indexOf(e.currentTarget)+1;t=c[r]??c[0];break}case"ArrowLeft":{const r=c.indexOf(e.currentTarget)-1;t=c[r]??c[c.length-1];break}}t?.focus()};return a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":r},t)},u.map((e=>{let{value:t,label:r,attributes:o}=e;return a.createElement("li",(0,n.Z)({role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,key:t,ref:e=>c.push(e),onKeyDown:h,onClick:d},o,{className:(0,i.Z)("tabs__item",v.tabItem,o?.className,{"tabs__item--active":s===t})}),r??t)})))}function f(e){let{lazy:t,children:r,selectedValue:n}=e;const i=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=i.find((e=>e.props.value===n));return e?(0,a.cloneElement)(e,{className:"margin-top--md"}):null}return a.createElement("div",{className:"margin-top--md"},i.map(((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==n}))))}function y(e){const t=m(e);return a.createElement("div",{className:(0,i.Z)("tabs-container",v.tabList)},a.createElement(k,(0,n.Z)({},e,t)),a.createElement(f,(0,n.Z)({},e,t)))}function w(e){const t=(0,b.Z)();return a.createElement(y,(0,n.Z)({key:String(t)},e))}},9494:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>g,frontMatter:()=>s,metadata:()=>u,toc:()=>p});var n=r(7462),a=(r(7294),r(3905)),i=r(4866),o=r(5162);const s={title:"Single-touch conversion Attribution",sidebar_position:49,more_data:[{apis:["Attribution Reporting API"]},{parties:["Publisher","SSP","Advertiser","DSP"]}]},l="Single-touch conversion Attribution",u={unversionedId:"demos/single-touch-conversion-attribution",id:"demos/single-touch-conversion-attribution",title:"Single-touch conversion Attribution",description:"Overview",source:"@site/docs/demos/single-touch-conversion-attribution.md",sourceDirName:"demos",slug:"/demos/single-touch-conversion-attribution",permalink:"/docs/demos/single-touch-conversion-attribution",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/demos/single-touch-conversion-attribution.md",tags:[],version:"current",sidebarPosition:49,frontMatter:{title:"Single-touch conversion Attribution",sidebar_position:49,more_data:[{apis:["Attribution Reporting API"]},{parties:["Publisher","SSP","Advertiser","DSP"]}]},sidebar:"docsSidebar",previous:{title:"Retargeting / Remarketing",permalink:"/docs/demos/retargeting-remarketing"}},c={},p=[{value:"Overview",id:"overview",level:2},{value:"Description",id:"description",level:3},{value:"Privacy Sandbox APIs",id:"privacy-sandbox-apis",level:3},{value:"Related parties",id:"related-parties",level:3},{value:"Scope",id:"scope",level:2},{value:"Goals",id:"goals",level:3},{value:"Assumptions",id:"assumptions",level:3},{value:"Key Exclusions",id:"key-exclusions",level:3},{value:"System Design",id:"system-design",level:3},{value:"Attribution Reporting Flow",id:"attribution-reporting-flow",level:4},{value:"User Journey #1",id:"user-journey-1",level:4},{value:"Demo",id:"demo",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"User Journey #1",id:"user-journey-1-1",level:3},{value:"Implementation details",id:"implementation-details",level:3},{value:"In (5) how do we attribute the conversion to seeing an ad ?",id:"in-5-how-do-we-attribute-the-conversion-to-seeing-an-ad-",level:4},{value:"Related API documentation",id:"related-api-documentation",level:3}],d={toc:p},h="wrapper";function g(e){let{components:t,...s}=e;return(0,a.kt)(h,(0,n.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"single-touch-conversion-attribution"},"Single-touch conversion Attribution"),(0,a.kt)(i.Z,{mdxType:"Tabs"},(0,a.kt)(o.Z,{value:"overview",label:"Overview",default:!0,mdxType:"TabItem"},(0,a.kt)("h2",{id:"overview"},"Overview"),(0,a.kt)("h3",{id:"description"},"Description"),(0,a.kt)("p",null,"This type of measurement tracks conversions that occur directly as a result of seeing an ad, such as when a user clicks on an ad and then makes a purchase on the advertiser's website.\nSingle-touch attribution models are easy to understand and implement, and they can be a good option for businesses with limited data or resources. However, they can also be inaccurate, as they do not account for the influence of other touch points on a conversion."),(0,a.kt)("h3",{id:"privacy-sandbox-apis"},"Privacy Sandbox APIs"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.chrome.com/en/docs/privacy-sandbox/attribution-reporting/"},"Attribution Reporting API")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.chrome.com/docs/privacy-sandbox/aggregation-service/"},"Aggregation Service"))),(0,a.kt)("h3",{id:"related-parties"},"Related parties"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Publisher"),(0,a.kt)("li",{parentName:"ul"},"SSP"),(0,a.kt)("li",{parentName:"ul"},"Advertiser"),(0,a.kt)("li",{parentName:"ul"},"DSP"))),(0,a.kt)(o.Z,{value:"scope",label:"Scope",mdxType:"TabItem"},(0,a.kt)("h2",{id:"scope"},"Scope"),(0,a.kt)("h3",{id:"goals"},"Goals"),(0,a.kt)("p",null,"In this demo, we assume an advertiser would like to measure the effectiveness of marketing campaigns. Single-touch attribution can help by tracking the number of conversions as well as the purchased value that can be attributed to each touch point (viewing or clicking an ad). This information can be used to improve the advertiser\u2019s marketing campaigns and get more value from their marketing budget."),(0,a.kt)("h3",{id:"assumptions"},"Assumptions"),(0,a.kt)("p",null,"This use case assumes the advertiser (e.g. EC site) has contracted with a publisher or won a bid to display their product ads on the publisher site (e.g. News site). This use case does not cover ad-targeting specifics, so we assume the user would be presented with a relevant ad leading to a conversion (purchase of a product)."),(0,a.kt)("h3",{id:"key-exclusions"},"Key Exclusions"),(0,a.kt)("p",null,"The demo does not show Aggregation Service and noised aggregation reports. The current demo shows the aggregatable reports (debug report non-encrypted) before it is sent to the aggregation service (encrypted)."),(0,a.kt)("h3",{id:"system-design"},"System Design"),(0,a.kt)("p",null,"The user visits a news site where an ad is rendered. Using Attribution Reporting API & Summary Reports, a view-through conversion source event is registered. The user clicks on the ads, a click-through conversion source is registered. Then the user navigates to the advertiser page (shopping site), clicks \u201cAdd to cart\u201d then \u201cCheckout\u201d. The browser registers a conversion trigger event and a summary report (debug report) is sent to the advertiser."),(0,a.kt)("h4",{id:"attribution-reporting-flow"},"Attribution Reporting Flow"),(0,a.kt)("p",null,"Below is a general introduction of Single-Touch conversion Attribution using Privacy Sandbox Attribution Reporting API. For further information see ",(0,a.kt)("a",{parentName:"p",href:"https://developer.chrome.com/docs/privacy-sandbox/attribution-reporting/"},"Attribution Reporting - Chrome Developers")," ."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Protected Audience Flow",src:r(1244).Z,width:"1452",height:"816"})),(0,a.kt)("h4",{id:"user-journey-1"},"User Journey #1"),(0,a.kt)("mermaid",{value:"sequenceDiagram\nTitle: Single-touch conversion Attribution - User Journey 1\n\nparticipant Browser\nparticipant Publisher\nparticipant SSP\nparticipant Advertiser\nparticipant DSP\n\nBrowser-)Publisher:visits a publisher site and sees an ad\nBrowser->>SSP:Load ad creative\nSSP--\x3e>Browser:Attribution-Reporting-Register-Source:{...} json config\n\nBrowser--\x3e>Browser:Register Attribution Source\n\n\nBrowser-)Advertiser:visits the advertiser site and check out\nBrowser->>SSP: Load attribution pixel\nSSP--\x3e>Browser:Attribution-Reporting-Register-Trigger:{...} json config\n\nBrowser--\x3e>Browser:Register Attribution Trigger\n\nBrowser--\x3e>Browser:Attribution logic & create report\n\nNote right of Browser: debug reports <br/>are sent immediately\nBrowser-)SSP:sends aggregatable report (Debug Report)\n\nNote over SSP:Scenario 1 stops here<br/>where we visualize<br/>debug reports"})),(0,a.kt)(o.Z,{value:"demo",label:"Demo",mdxType:"TabItem"},(0,a.kt)("h2",{id:"demo"},"Demo"),(0,a.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Chrome > v107 (Open chrome://version to look up your current version)"),(0,a.kt)("li",{parentName:"ul"},"Enable Privacy Sandbox APIs (Open chrome://settings/privacySandbox to enable this setting)"),(0,a.kt)("li",{parentName:"ul"},"Clear your browsing history before you run one of the demo scenario below (Open chrome://settings/clearBrowserData to delete your browsing history)"),(0,a.kt)("li",{parentName:"ul"},"Open chrome://attribution-internals and click \u201cClear all attribution data\u201d")),(0,a.kt)("h3",{id:"user-journey-1-1"},"User Journey #1"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://privacy-sandbox-demos-shop.dev/"},"Navigate to shop site")," (advertiser)"),(0,a.kt)("li",{parentName:"ol"},"Click on a \u201cshoe\u201d product item on the shop site.")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The shop (advertiser) would assume the user is interested in this type of product, so they would leverage Protected Audience API and ask the browser to join an ad interest group for this product or this specific product category.")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("a",{parentName:"li",href:"https://privacy-sandbox-demos-news.dev/"},"Navigate to the news site")," (publisher)"),(0,a.kt)("li",{parentName:"ol"},"Observe the ad served on the news site")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"If you previously browsed the \u201cshoe\u201d product on the shop site, you will be shown an ad for the same product."),(0,a.kt)("li",{parentName:"ul"},"Displaying the ad will also register a view-through conversion ",(0,a.kt)("strong",{parentName:"li"},"source")," event into your browser using the ",(0,a.kt)("strong",{parentName:"li"},"Attribution Reporting API"),".")),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Click on the ad served on the news site")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"your browser will open a new window with the product page"),(0,a.kt)("li",{parentName:"ul"},"Clicking the ad will also register a click-through conversion ",(0,a.kt)("strong",{parentName:"li"},"source")," event into your browser using the ",(0,a.kt)("strong",{parentName:"li"},"Attribution Reporting API"),".")),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},"Navigate to chrome://attribution-internals/ and click the ",(0,a.kt)("inlineCode",{parentName:"li"},"Active Sources")," tab")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"At the bottom of the page, you will see 2 ",(0,a.kt)("strong",{parentName:"li"},"sources")," with the status ",(0,a.kt)("inlineCode",{parentName:"li"},"Attributable"),", the ",(0,a.kt)("inlineCode",{parentName:"li"},"source origin")," is the ",(0,a.kt)("strong",{parentName:"li"},"news")," site, the ",(0,a.kt)("inlineCode",{parentName:"li"},"destination")," is the ",(0,a.kt)("strong",{parentName:"li"},"shop")," site and the ",(0,a.kt)("inlineCode",{parentName:"li"},"reporting origin")," is the ",(0,a.kt)("strong",{parentName:"li"},"SSP")," service. One of the ",(0,a.kt)("inlineCode",{parentName:"li"},"source type")," is ",(0,a.kt)("strong",{parentName:"li"},"event")," (for view-through) and the other one is ",(0,a.kt)("strong",{parentName:"li"},"navigation")," (for click-through) This reference will be used later to attribute (match) the conversion (here the. purchase of an item on the ",(0,a.kt)("strong",{parentName:"li"},"shop")," site) to a previous event (here. The user saw/clicked an ad on the ",(0,a.kt)("strong",{parentName:"li"},"news")," site)")),(0,a.kt)("ol",{start:7},(0,a.kt)("li",{parentName:"ol"},"On the product page, click \u201cAdd to cart\u201d"),(0,a.kt)("li",{parentName:"ol"},"On the cart page, click \u201cCheckout\u201d")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"In this scenario the \u201ccheckout\u201d event is the conversion event the advertiser wants to measure to evaluate the performance of their ad campaign,"),(0,a.kt)("li",{parentName:"ul"},"The checkout page registers a conversion attribution ",(0,a.kt)("strong",{parentName:"li"},"trigger")," event in the browser. The ",(0,a.kt)("strong",{parentName:"li"},"Attribution Reporting API")," logic will then process the event.")),(0,a.kt)("ol",{start:9},(0,a.kt)("li",{parentName:"ol"},"Navigate to chrome://attribution-internals/ and click the ",(0,a.kt)("inlineCode",{parentName:"li"},"Trigger Registration")," tab")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"At the bottom of the page, you will see 1 ",(0,a.kt)("strong",{parentName:"li"},"trigger")," . the ",(0,a.kt)("inlineCode",{parentName:"li"},"destination")," is the ",(0,a.kt)("strong",{parentName:"li"},"shop")," site and the ",(0,a.kt)("inlineCode",{parentName:"li"},"reporting origin")," is the ",(0,a.kt)("strong",{parentName:"li"},"SSP")," service. The ",(0,a.kt)("inlineCode",{parentName:"li"},"Registration JSON")," contains information about the conversion event. In this scenario the advertiser chose to report the gross price and the quantity of the product item purchased. the ",(0,a.kt)("inlineCode",{parentName:"li"},"Aggregatable Status")," indicates ",(0,a.kt)("strong",{parentName:"li"},"Success: Report stored"),", it means Attribution Reporting API has now stored this report in the browser. It will then be scheduled for sending to the ",(0,a.kt)("inlineCode",{parentName:"li"},"reporting origin")," at a later time.")),(0,a.kt)("ol",{start:10},(0,a.kt)("li",{parentName:"ol"},"Navigate to ",(0,a.kt)("a",{parentName:"li",href:"https://privacy-sandbox-demos-ssp.dev/reports"},"SSP service report visualization page"))),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"on this page you can see the aggregatable report sent by the browser to the SSP. In a production environment, the aggregatable report is encrypted by the browser and sent to the SSP. There, they will be batched and sent to the Aggregation Service where they will be aggregated and noised to preserve privacy. However for development and testing purposes, you can also send an unencrypted version called ",(0,a.kt)("strong",{parentName:"li"},"debug report"),". This is what you are seeing now."),(0,a.kt)("li",{parentName:"ul"},"The report shows aggregation data on 2 dimensions : gross with a value of 180 and quantity with a value of 1.")),(0,a.kt)("h3",{id:"implementation-details"},"Implementation details"),(0,a.kt)("h4",{id:"in-5-how-do-we-attribute-the-conversion-to-seeing-an-ad-"},"In (5) how do we attribute the conversion to seeing an ad ?"),(0,a.kt)("p",null,"First on the Attribution Source registration side.\nLook at the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/privacysandbox/privacy-sandbox-demos/blob/main/services/ssp/src/views/ads.html.ejs"},"code")," displaying the ad creative"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<a\n  width="300"\n  height="250"\n  target="_blank"\n  attributionsrc=""\n  href="https://privacy-sandbox-demos-ssp.dev/move?advertiser=privacy-sandbox-demos-shop.dev&amp;id=1f45e"\n>\n  <img\n    width="294"\n    height="245"\n    loading="lazy"\n    attributionsrc=""\n    src="https://privacy-sandbox-demos-ssp.dev/creative?advertiser=privacy-sandbox-demos-shop.dev&amp;id=1f45e"\n  />\n</a>\n')),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"img")," tag also specifies the ",(0,a.kt)("inlineCode",{parentName:"p"},"attributionsrc")," attribute. It means that showing this ad will register a view-through attribution source event in the browser."),(0,a.kt)("p",null,"Now using Developers Tools, look at the HTTP request you will see a new attribute added by the browser ",(0,a.kt)("inlineCode",{parentName:"p"},"Attribution-Reporting-Eligible")," with the value ",(0,a.kt)("inlineCode",{parentName:"p"},"event-source, trigger"),"."),(0,a.kt)("p",null,"In the HTTP response to the ",(0,a.kt)("inlineCode",{parentName:"p"},"/creative")," request, you will see a new header ",(0,a.kt)("inlineCode",{parentName:"p"},"Attribution-Reporting-Register-Source:")," with a value that contains the attribution source parameters."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "destination": "https://privacy-sandbox-demos-shop.dev",\n  "source_event_id": "18446744073709551615",\n  "debug_key": "18446744073709551614",\n  "aggregation_keys": { "quantity": "0xc001f45e000000000000000000000000", "gross": "0xc101f45e000000000000000000000000" }\n}\n')),(0,a.kt)("p",null,"You can also refer to the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/privacysandbox/privacy-sandbox-demos/blob/8a33afb7433ed70e639047316c5bff30d61be58b/services/ssp/src/index.js#L177"},"source code")," to see how the response header ",(0,a.kt)("inlineCode",{parentName:"p"},"Attribution-Reporting-Register-Source")," was formed."),(0,a.kt)("p",null,"Second, on the Attribution Trigger side (=Conversion)\nThe checkout page contains a 1 pixel image loaded from the code"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-html"},'<img\n  alt=""\n  width="1"\n  height="1"\n  src="https://privacy-sandbox-demos-ssp.dev/register-trigger?id=1f45e&amp;category=1&amp;quantity=2&amp;size=50&amp;gross=180"\n/>\n')),(0,a.kt)("p",null,"Now using the Developers Tools, look at the HTTP response to the ",(0,a.kt)("inlineCode",{parentName:"p"},"/register-trigger")," request. You will see a new header ",(0,a.kt)("inlineCode",{parentName:"p"},"Attribution-Reporting-Register-Trigger:")," with a value that contains the attribution trigger parameters, including the values the advertiser would like to see aggregated in the summary report (in this example gross and quantities)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "aggregatable_trigger_data": [\n    { "key_piece": "0x00000000000000008001f45e32010000", "source_keys": ["quantity"] },\n    { "key_piece": "0x0000000000000000c001f45e32010000", "source_keys": ["gross"] }\n  ],\n  "aggregatable_values": { "quantity": 2, "gross": 180 },\n  "debug_key": "18446744073709551614"\n}\n')),(0,a.kt)("p",null,"You can also refer to the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/privacysandbox/privacy-sandbox-demos/blob/8a33afb7433ed70e639047316c5bff30d61be58b/services/ssp/src/index.js#L185"},"source code")," to see how the response header ",(0,a.kt)("inlineCode",{parentName:"p"},"aggregatable_trigger_data")," was formed."),(0,a.kt)("h3",{id:"related-api-documentation"},"Related API documentation"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.chrome.com/docs/privacy-sandbox/attribution-reporting/"},"Attribution Reporting - Chrome Developers")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://docs.google.com/document/d/1BXchEk-UMgcr2fpjfXrQ3D8VhTR-COGYS1cwK_nyLfg/view"},"Handbook (Experiment with Attribution Reporting)")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developer.chrome.com/docs/privacy-sandbox/attribution-reporting-debugging/part-2/"},"Set up debug reports - Chrome Developers"))))))}g.isMDXComponent=!0},1244:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/images/attribution-reporting-flow-fed8748b9b699e913fa44d5d24836fb4.png"}}]);